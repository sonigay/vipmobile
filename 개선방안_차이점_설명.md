# 개선 방안 1번 vs 2번 차이점

## 📊 개선 방안 비교

### 방안 1: TodaysProductCard에 Discord 자동 갱신 로직 추가

#### 동작 방식
```
이미지 로드 실패 감지
    ↓
즉시 Discord API 호출 (threadId, messageId 사용)
    ↓
새 URL 받아오기
    ↓
이미지 src 업데이트
    ↓
이미지 자동 복구 ✅
```

#### 특징
- ✅ **실시간 복구**: 이미지 로드 실패 시 즉시 자동 복구
- ✅ **슬라이드 중 작동**: 슬라이드가 실행 중이어도 자동으로 이미지 복구
- ✅ **개별 처리**: 각 이미지가 독립적으로 처리됨
- ✅ **Google Sheets 불필요**: Discord API에서 직접 새 URL 가져옴
- ✅ **사용자 경험**: 사용자가 아무것도 하지 않아도 자동 복구
- ⚠️ **Discord API 호출**: 각 이미지마다 API 호출 (Rate Limit 고려 필요)

#### 코드 예시
```javascript
// TodaysProductCard.js의 onError 핸들러에 추가
if (isDiscordUrl && product.discordThreadId && product.discordMessageId) {
  attachDiscordImageRefreshHandler(
    e.target,
    product.discordThreadId,
    product.discordMessageId,
    (newUrl) => {
      // 갱신 성공 시 이미지 자동 복구
      console.log('✅ 이미지 자동 복구 완료');
    }
  );
}
```

---

### 방안 2: 주기적 데이터 새로고침

#### 동작 방식
```
일정 간격마다 (예: 1분)
    ↓
Google Sheets에서 전체 데이터 재로드
    ↓
이미 갱신된 새 URL 포함된 데이터 가져오기
    ↓
컴포넌트 리렌더링
    ↓
새 URL로 이미지 표시 ✅
```

#### 특징
- ✅ **간단한 구현**: 기존 fetchData() 함수만 주기적으로 호출
- ✅ **일괄 처리**: 모든 데이터를 한 번에 업데이트
- ✅ **Google Sheets 활용**: 이미 갱신된 URL을 Sheets에서 가져옴
- ⚠️ **지연 발생**: 주기적 새로고침까지 대기 필요 (예: 최대 1분)
- ⚠️ **슬라이드 중단 가능**: 데이터 새로고침 시 슬라이드가 리셋될 수 있음
- ⚠️ **불필요한 로드**: 정상 이미지도 다시 로드됨

#### 코드 예시
```javascript
// TodaysMobileTab.js에 추가
useEffect(() => {
  // 1분마다 데이터 새로고침
  const interval = setInterval(() => {
    fetchData();
  }, 60000); // 60초
  
  return () => clearInterval(interval);
}, [fetchData]);
```

---

## 🔍 핵심 차이점 요약

| 구분 | 방안 1 (자동 갱신) | 방안 2 (주기적 새로고침) |
|------|-------------------|------------------------|
| **복구 시점** | 즉시 (이미지 로드 실패 시) | 주기적 (예: 1분마다) |
| **슬라이드 중 작동** | ✅ 작동 (자동 복구) | ⚠️ 슬라이드 리셋 가능 |
| **데이터 소스** | Discord API 직접 호출 | Google Sheets |
| **처리 단위** | 개별 이미지 | 전체 데이터 |
| **사용자 경험** | ✅ 투명한 자동 복구 | ⚠️ 주기적 새로고침 대기 |
| **API 호출** | 이미지별 Discord API | 주기적 Sheets API |
| **구현 복잡도** | 중간 (로직 추가 필요) | 낮음 (간단한 interval) |

---

## 💡 추천 방안

### **방안 1 (자동 갱신) 추천**

**이유**:
1. ✅ **사용자 경험 우수**: 이미지가 사라지자마자 자동으로 복구
2. ✅ **슬라이드 중단 없음**: 슬라이드가 실행 중이어도 자동 복구
3. ✅ **실시간 대응**: 직영점관리모드에서 갱신 완료 후 즉시 반영 가능
4. ✅ **MobileListRow와 일관성**: 이미 구현된 로직과 동일한 방식

**단점 보완**:
- Discord API Rate Limit: 이미지 로드 실패 시에만 호출되므로 부담 적음
- 구현 복잡도: 기존 `attachDiscordImageRefreshHandler` 함수 재사용 가능

---

## 🎯 결론

**방안 1**은 사용자가 아무것도 하지 않아도 이미지가 자동으로 복구되는 **프로액티브(Proactive)** 방식이고,  
**방안 2**는 주기적으로 데이터를 새로고침하는 **리액티브(Reactive)** 방식입니다.

**방안 1을 추천**하는 이유는 사용자 경험이 훨씬 좋고, 슬라이드가 실행 중이어도 문제없이 작동하기 때문입니다.


