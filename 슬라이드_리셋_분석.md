# 슬라이드 리셋 분석

## 🔍 현재 코드 분석

### fetchData() 호출 시 동작

```javascript
// fetchData() 함수
const fetchData = useCallback(async () => {
  setLoading(true);  // ← loading 상태 변경
  // ... 데이터 로드 ...
  setPremiumPhones(premium);
  setBudgetPhones(budget);
  setLoading(false);
}, []);
```

### 슬라이드 데이터 준비

```javascript
// useEffect: loading이 false가 되면 슬라이드 데이터 준비
useEffect(() => {
  if (!loading) {
    prepareSlideshowData();  // ← 슬라이드 데이터 재생성
  }
}, [loading, prepareSlideshowData]);
```

### 슬라이드 상태 관리

```javascript
// 슬라이드 상태
const [slideshowData, setSlideshowData] = useState([]);
const [currentSlideIndex, setCurrentSlideIndex] = useState(0);
const [isSlideshowActive, setIsSlideshowActive] = useState(false);
```

## ❓ 리셋 발생 여부

### 현재 동작

1. **fetchData() 호출 시**:
   - `setLoading(true)` → `setLoading(false)`
   - `setPremiumPhones()`, `setBudgetPhones()` 호출
   - **`setCurrentSlideIndex()`는 호출하지 않음** ✅

2. **useEffect 트리거**:
   - `loading`이 `false`가 되면 `prepareSlideshowData()` 호출
   - `setSlideshowData()`로 슬라이드 데이터 재생성
   - **하지만 `setCurrentSlideIndex()`는 호출하지 않음** ✅

3. **슬라이드 실행 중**:
   - `currentSlideIndex`는 그대로 유지됨
   - 다음 슬라이드로 넘어갈 때 새로운 `slideshowData` 사용

### 결론: 리셋은 발생하지 않음 ✅

**하지만 문제점**:
- 슬라이드 데이터가 재생성되면 구조가 바뀔 수 있음
- `currentSlideIndex`가 새로운 데이터의 범위를 벗어날 수 있음
- 예: 이전에 10개 슬라이드였는데, 새로고침 후 8개가 되면 인덱스 9는 범위 초과

---

## 💡 개선 방안: 하이브리드 접근

### 방안 3: 스마트 데이터 업데이트 (추천)

**개념**: 
- 이미지는 방안 1 (자동 갱신)
- 금액 등 다른 데이터는 부분 업데이트 (슬라이드 리셋 없이)

**구현 방법**:

1. **이미지 자동 갱신** (방안 1)
   - TodaysProductCard에 Discord 자동 갱신 로직 추가
   - 이미지 로드 실패 시 즉시 복구

2. **데이터 부분 업데이트** (새로운 방안)
   - fetchData()를 전체 호출하지 않고, 가격 데이터만 업데이트
   - 슬라이드 데이터는 업데이트하지 않음
   - 또는 슬라이드 데이터를 업데이트하되, currentSlideIndex는 유지

**코드 예시**:
```javascript
// 가격 데이터만 업데이트하는 함수
const updatePricingData = useCallback(async () => {
  const [skPricing, ktPricing, lgPricing] = await Promise.all([
    directStoreApiClient.getMobilesPricing('SK'),
    directStoreApiClient.getMobilesPricing('KT'),
    directStoreApiClient.getMobilesPricing('LG')
  ]);
  
  const allPricing = [...skPricing, ...ktPricing, ...lgPricing];
  setMasterPricing(/* 가격 데이터 업데이트 */);
  
  // 슬라이드 데이터는 업데이트하지 않음 (리셋 방지)
}, []);
```

---

## 📊 방안 비교

| 구분 | 방안 1 | 방안 2 | 방안 3 (하이브리드) |
|------|--------|--------|-------------------|
| **이미지 복구** | ✅ 즉시 | ⚠️ 주기적 | ✅ 즉시 |
| **금액 업데이트** | ❌ 안 됨 | ✅ 됨 | ✅ 됨 |
| **슬라이드 리셋** | ✅ 없음 | ⚠️ 가능성 | ✅ 없음 |
| **구현 복잡도** | 중간 | 낮음 | 높음 |

---

## 🎯 최종 추천

### 방안 3 (하이브리드) 추천

**이유**:
1. ✅ 이미지 즉시 복구 (방안 1의 장점)
2. ✅ 금액 등 데이터 업데이트 (방안 2의 장점)
3. ✅ 슬라이드 리셋 없음 (사용자 요구사항)

**구현 방법**:
1. TodaysProductCard에 Discord 자동 갱신 로직 추가
2. 주기적으로 가격 데이터만 업데이트하는 함수 추가
3. 슬라이드 데이터는 업데이트하지 않음

**단점**:
- 구현 복잡도가 높음
- 두 가지 로직을 모두 구현해야 함

---

## 🔄 대안: 방안 2 + 리셋 방지 로직

만약 방안 3이 복잡하다면, 방안 2에 리셋 방지 로직을 추가할 수 있습니다:

```javascript
// fetchData() 수정: 슬라이드 실행 중이면 슬라이드 데이터 업데이트 안 함
const fetchData = useCallback(async () => {
  // ... 데이터 로드 ...
  
  // 슬라이드가 실행 중이면 슬라이드 데이터는 업데이트하지 않음
  if (!isSlideshowActive) {
    // 슬라이드 데이터 업데이트
    prepareSlideshowData();
  }
  
  // 가격 데이터는 항상 업데이트
  setMasterPricing(/* ... */);
}, [isSlideshowActive]);
```

이렇게 하면:
- ✅ 금액 등 데이터는 업데이트됨
- ✅ 슬라이드 실행 중에는 리셋 없음
- ⚠️ 이미지는 주기적 새로고침까지 대기 필요

