# 회의 모드 슬라이드 기능 구현 플랜

> 회의 모드에 회의준비 탭과 회의진행 탭을 추가하여, 관리자 모드의 화면들을 슬라이드 형태로 순서대로 보여주는 기능을 구현합니다.
> 
> **중요**: 이 플랜 파일은 로컬에서만 관리하며, 깃에 커밋하지 않습니다.

---

## 1. 기능 개요

### 1.1 목적
- 회의 중 관리자 모드의 각 화면을 PPT처럼 순서대로 전체화면으로 보여주기
- 회의 전에 보여줄 모드와 탭을 선택하고 순서를 설정할 수 있도록 함
- 회의 생성 시 자동으로 화면을 캡처하여 차수별로 관리
- 지난 회의의 캡처된 화면을 재생하여 당시 상태 확인

### 1.2 주요 기능
1. **회의준비 탭**: 회의에 사용할 모드/탭 선택 및 순서 설정, 회의 목록 관리
2. **회의 생성 및 자동 캡처**: 회의 생성 시 설정된 화면들을 자동으로 캡처하여 Discord에 저장
3. **회의진행 탭**: 지난 회의 선택 시 캡처된 이미지로 슬라이드 재생
4. **슬라이드 네비게이션**: 스페이스바/클릭으로 다음 화면, ESC로 종료
5. **추가 화면 기능**: 중간에 커스텀 화면 추가 가능
6. **회의 이력 관리**: 차수별로 지난 회의 목록 조회 및 재생

---

## 2. 상세 요구사항

### 2.1 회의준비 탭

#### 2.1.1 모드/탭 선택 기능
- **사용 가능한 모드 목록 표시**
  - 현재 사용자의 `loggedInStore.modePermissions`에서 권한이 있는 모드만 표시
  - 각 모드의 타이틀과 아이콘 표시 (modeConfig.js 참조)
  - 예: OB 관리 모드, 장표 모드, 예산 모드, 검수 모드 등

- **각 모드의 탭 목록 표시**
  - 선택한 모드에 따라 해당 모드의 탭 목록을 동적으로 표시
  - 예: OB 관리 모드 선택 시 → "투게더 계산기", "OB 정산 확인", "OB 정산 관리"
  - 예: 장표 모드 선택 시 → "마감장표", "채권장표", "지표장표", "재고장표"
  - 권한이 없는 탭은 표시하지 않음

- **체크박스로 선택**
  - 각 탭에 체크박스 제공
  - 여러 모드의 여러 탭을 동시에 선택 가능

#### 2.1.2 순서 설정 기능
- **드래그 앤 드롭으로 순서 변경**
  - 선택된 탭들을 리스트로 표시
  - 드래그 앤 드롭으로 순서 변경 가능
  - 또는 위/아래 화살표 버튼으로 순서 조정

- **순서 표시**
  - 각 항목에 순서 번호 표시 (1, 2, 3, ...)
  - 모드명과 탭명을 함께 표시 (예: "OB 관리 모드 > OB 정산 확인")

#### 2.1.3 추가 화면 기능
- **커스텀 화면 추가**
  - 중간에 추가할 수 있는 빈 화면 또는 텍스트 화면
  - 예: "회의 안내", "질의응답 시간", "다음 주제로 이동" 등
  - 추가 화면도 순서에 포함되어 드래그 앤 드롭으로 위치 변경 가능

- **추가 화면 편집**
  - 제목, 내용, 배경색 등을 설정 가능
  - 간단한 마크다운 또는 HTML 지원 검토

#### 2.1.4 회의 목록 관리
- **회의 생성 및 목록 표시**
  - 회의 이름, 날짜, 차수(수동 입력) 등을 입력하여 새 회의 생성
  - 생성된 회의 목록을 테이블/카드 형태로 표시
  - 차수별로 정렬 (최신순/과거순)
  - 지난 회의와 예정된 회의 구분 표시
  - **차수 중복 방지**: 같은 날짜에 동일 차수가 이미 존재하면 경고 및 생성 방지

- **회의 생성 시 자동 캡처**
  - 회의 생성 버튼 클릭 시 설정된 모든 슬라이드를 순서대로 자동 캡처
  - 각 슬라이드의 실제 모드/탭 화면을 렌더링하여 캡처
  - 캡처 완료 후 Discord에 업로드 및 구글시트에 URL 저장
  - 캡처 진행 상황 표시 (진행 바, 완료된 슬라이드 수 등)

- **회의 선택 및 편집**
  - 목록에서 회의 선택 시 해당 회의의 설정(모드/탭/순서) 불러오기
  - 회의 정보 수정 가능 (이름, 날짜 등)
  - 회의 삭제 기능 (구글시트에서만 삭제, Discord 이미지는 유지)

- **회의 설정 저장**
  - 선택한 모드/탭과 순서를 구글시트에 저장
  - 회의별로 독립적인 설정 관리
  - 회의 ID를 통한 고유 식별

---

### 2.2 회의진행 탭

#### 2.2.1 회의 선택
- **회의 목록 표시**
  - 회의진행 탭에서 지난 회의 목록 표시
  - 회의 이름, 날짜, 차수, 생성자 정보 표시
  - 차수별로 정렬

- **회의 선택 및 재생**
  - 목록에서 회의 선택 시 해당 회의의 캡처된 이미지들을 슬라이드 형태로 재생
  - 실제 모드 컴포넌트가 아닌 이미지로 표시 (당시 화면 보존)

#### 2.2.2 이미지 슬라이드 재생
- **이미지 로딩 및 표시**
  - 구글시트에서 해당 회의의 이미지 URL 목록 불러오기
  - 이미지 preload (다음 이미지 미리 로딩)
  - 순서대로 이미지를 전체화면으로 표시
  - 로딩 중 스피너 및 진행 상태 표시

- **전체화면 모드**
  - 이미지 슬라이드 재생 시 전체화면 모드 진입
  - 브라우저 전체화면 API 사용 (Fullscreen API)
  - 상단/하단 네비게이션 바 숨김

#### 2.2.3 네비게이션 기능
- **다음 화면 이동**
  - 스페이스바 키 입력 시 다음 화면으로 이동
  - 마우스 클릭 시 다음 화면으로 이동
  - 화면 하단에 "다음" 버튼 표시 (선택사항)

- **이전 화면 이동**
  - 좌측 화살표 키 또는 백스페이스로 이전 화면 이동
  - 화면 하단에 "이전" 버튼 표시 (선택사항)

- **전체화면 종료**
  - ESC 키 입력 시 전체화면 모드 종료
  - 화면 우측 상단에 "종료" 버튼 표시

#### 2.2.4 진행 상태 표시
- **슬라이드 인디케이터**
  - 현재 몇 번째 화면인지 표시 (예: "3 / 10")
  - 진행 바 표시 (선택사항)

- **현재 화면 정보**
  - 현재 보여주는 모드명과 탭명 표시 (작은 폰트로 상단 또는 하단)

---

## 3. 기술 구현 방안

### 3.1 데이터 구조

```javascript
// 회의 메타데이터 구조 (구글시트: 회의목록 시트)
const meetingMetadata = {
  meetingId: "meeting-2025-01-15-001", // 고유 ID
  meetingName: "2025년 1월 주간회의",
  meetingDate: "2025-01-15",
  meetingNumber: 1, // 차수 (수동 입력)
  createdBy: "사용자명",
  createdAt: "2025-01-15T10:00:00Z",
  status: "completed" // "preparing" | "capturing" | "completed"
};

// 회의 설정 데이터 구조 (구글시트: 회의설정 시트)
const meetingConfig = {
  meetingId: "meeting-2025-01-15-001",
  slides: [
    {
      id: "slide-1",
      type: "mode-tab", // "mode-tab" 또는 "custom"
      mode: "obManagement",
      tab: "overview",
      order: 1,
      capturedImageUrl: "https://cdn.discordapp.com/attachments/.../image1.png", // 캡처 후 저장
      capturedAt: "2025-01-15T10:30:00Z", // 캡처 시간
      discordPostId: "1234567890", // Discord 포스트 ID
      discordThreadId: "0987654321" // Discord 스레드 ID
    },
    {
      id: "slide-2",
      type: "custom",
      title: "회의 안내",
      content: "오늘 회의 주제는...",
      backgroundColor: "#ffffff",
      order: 2,
      capturedImageUrl: "https://cdn.discordapp.com/attachments/.../image2.png",
      capturedAt: "2025-01-15T10:30:05Z",
      discordPostId: "1234567890",
      discordThreadId: "0987654321"
    }
  ]
};
```

### 3.2 구글시트 구조

**시트 1: "회의목록"**
```
회의ID | 회의이름 | 회의날짜 | 차수 | 생성자 | 생성일시 | 상태 | 회의장소 | 참석자
meeting-2025-01-15-001 | 2025년 1월 주간회의 | 2025-01-15 | 1 | 홍길동 | 2025-01-15 10:00 | completed | 본사 회의실 | 홍길동, 김철수, 이영희
```

**시트 2: "회의설정"**
```
회의ID | 슬라이드ID | 순서 | 타입 | 모드 | 탭 | 제목 | 내용 | 배경색 | 이미지URL | 캡처시간 | Discord포스트ID | Discord스레드ID
meeting-2025-01-15-001 | slide-1 | 1 | mode-tab | obManagement | overview | | | | https://cdn.discordapp.com/... | 2025-01-15 10:30:00 | 1234567890 | 0987654321
meeting-2025-01-15-001 | slide-2 | 2 | custom | | | 회의 안내 | 오늘 회의 주제는... | #ffffff | https://cdn.discordapp.com/... | 2025-01-15 10:30:05 | 1234567890 | 0987654321
```

**구글시트 생성 가이드**
1. 기존 구글시트에 다음 시트들을 추가합니다:
   - 시트 이름: `회의목록`
   - 시트 이름: `회의설정`
2. 각 시트의 1행은 비워두고, 2행에 위의 헤더를 복사하여 붙여넣습니다.
3. 3행부터 데이터가 입력됩니다.

### 3.3 컴포넌트 구조

```
MeetingMode/
├── MeetingPreparationTab.js        # 회의준비 탭
│   ├── MeetingList.js              # 회의 목록 컴포넌트
│   ├── MeetingEditor.js            # 회의 생성/편집 모달
│   ├── ModeSelector.js             # 모드 선택 컴포넌트
│   ├── TabSelector.js              # 탭 선택 컴포넌트
│   ├── SlideOrderEditor.js         # 순서 편집 컴포넌트
│   ├── CustomSlideEditor.js        # 커스텀 화면 편집
│   └── CaptureProgress.js          # 캡처 진행 상황 표시
├── MeetingPresentationTab.js        # 회의진행 탭
│   ├── MeetingSelector.js         # 회의 선택
│   ├── FullscreenSlideView.js      # 전체화면 슬라이드 뷰
│   ├── ImageSlideRenderer.js       # 이미지 기반 슬라이드 렌더러
│   ├── SlideNavigator.js           # 네비게이션 컨트롤
│   └── ImagePreloader.js           # 이미지 preload 유틸리티
└── MeetingConfigManager.js         # 설정 저장/로드 관리
    ├── GoogleSheetService.js       # 구글시트 연동
    └── DiscordService.js           # Discord 이미지 업로드
```

### 3.4 화면 캡처 기술

**html2canvas 라이브러리 사용**
- DOM 요소를 Canvas로 변환 후 이미지로 저장
- **캡처 대상**: presentation mode로 렌더링된 콘텐츠 영역만 캡처
- **제외 대상**: 
  - 회의 모드 상단 AppBar (뒤로가기, 탭, 모드 변경 버튼 등)
  - 각 모드의 헤더/네비게이션 바
  - 브라우저 주소창 등
- 고해상도 캡처 설정 (1920x1080 이상, 4K 지원)
- 파일 크기 최적화 (압축, 품질 조절)

**캡처 프로세스 (회의 생성 시)**
1. 회의 생성 버튼 클릭
2. 설정된 슬라이드 순서대로 반복:
   a. 해당 모드/탭 컴포넌트를 **presentation mode로 렌더링** (헤더/네비게이션 숨김)
   b. 데이터 로딩 완료 대기
   c. **presentation mode로 렌더링된 콘텐츠 컨테이너만 선택**
   d. html2canvas로 Canvas 생성 (고해상도 설정)
   e. Canvas를 Blob으로 변환 (압축 적용)
   f. Discord API에 업로드
   g. Discord에서 반환된 이미지 URL 및 포스트/스레드 ID 획득
   h. 구글시트에 URL 저장
3. 모든 슬라이드 캡처 완료 후 회의 상태를 "completed"로 변경

**캡처되는 내용**
- ✅ 각 모드/탭의 실제 콘텐츠 (제목, 테이블, 차트, 폼 등)
- ✅ 커스텀 화면의 제목과 내용
- ❌ 회의 모드 상단 헤더 (제외)
- ❌ 각 모드의 헤더/네비게이션 (제외)

**캡처 설정**
```javascript
const captureOptions = {
  scale: 2, // 고해상도 (2배)
  useCORS: true,
  allowTaint: false,
  backgroundColor: '#ffffff',
  width: window.innerWidth,
  height: window.innerHeight,
  logging: false
};
```

### 3.5 Discord 봇 연동

**기존 Discord 봇 활용**
- `server/monitor.js`에 이미 Discord 봇 구현되어 있음
- 동일한 봇을 활용하여 이미지 업로드 기능 확장

**Discord 포럼 게시판 구조**
- 채널 ID: `1438813568374931578` (포럼 게시판)
- 년월별 포스트 자동 생성 (예: "2025-01 회의")
- 각 회의는 포스트 내의 스레드로 관리
- 이미지는 스레드에 업로드

**구현 방식**
```javascript
// server/meetingRoutes.js (신규 생성)
async function uploadImageToDiscord(imageBuffer, filename, meetingId, meetingDate) {
  const channel = await discordBot.channels.fetch('1438813568374931578');
  
  // 년월 추출 (예: "2025-01")
  const yearMonth = meetingDate.substring(0, 7);
  
  // 해당 년월의 포스트 찾기 또는 생성
  let post = await findOrCreatePost(channel, yearMonth);
  
  // 회의 스레드 찾기 또는 생성
  let thread = await findOrCreateThread(post, meetingId);
  
  // 이미지 업로드
  const attachment = new AttachmentBuilder(imageBuffer, { name: filename });
  const message = await thread.send({ files: [attachment] });
  
  return {
    imageUrl: message.attachments.first().url,
    postId: post.id,
    threadId: thread.id
  };
}
```

### 3.6 이미지 로딩 최적화

**Preload 전략**
- 현재 이미지 표시 중 다음 이미지 미리 로딩
- 이미지 캐싱 활용
- 로딩 중 스피너 및 진행 상태 표시

**로딩 UI**
- Material-UI CircularProgress 사용
- 이미지 로딩 중 반투명 오버레이 표시
- 로딩 완료 시 부드러운 전환 애니메이션

---

## 4. 구현 단계

### Phase 1: 기본 구조 및 회의 목록 관리 ✅
- [x] MeetingMode 컴포넌트에 탭 구조 추가 (회의준비/회의진행)
- [x] 구글시트 "회의목록" 시트 구조 생성 (사용자가 수동 생성)
- [x] 회의 목록 조회/표시 기능
- [x] 회의 생성 모달 (2단계: 모드/탭 선택 → 회의 정보 입력)
- [x] 차수 중복 방지 로직 (같은 날짜 + 같은 차수 체크)
- [x] 회의 편집/삭제 기능 (구글시트에서만 삭제)

### Phase 2: 회의준비 탭 - 모드/탭 선택 ✅
- [x] 회의준비 탭 UI 구현
- [x] 사용 가능한 모드 목록 표시 (권한이 있는 모든 모드)
- [x] 모드 선택 시 해당 모드의 탭 목록 표시
- [x] 탭 선택 체크박스 구현
- [x] 모드/탭 매핑 구조 정의 (modeTabConfig.js)
- [x] 하부 탭(서브탭) 선택 기능 추가 (예: 채권장표 > 재초담초채권)
- [x] 모드 전체 추가 기능 (탭이 없는 모드의 경우)

### Phase 3: 순서 설정 및 구글시트 저장 ✅
- [x] 선택된 탭 리스트 표시
- [x] 위/아래 화살표 버튼으로 순서 변경
- [x] 구글시트 "회의설정" 시트 구조 생성 (사용자가 수동 생성)
- [x] 회의 설정 저장 API 구현 (백엔드)
- [x] 회의 설정 불러오기 기능

### Phase 4: 커스텀 화면 추가 ✅
- [x] 커스텀 화면 추가 UI
- [x] 커스텀 화면 편집 모달
- [x] 커스텀 화면을 슬라이드 목록에 포함
- [x] 구글시트에 커스텀 화면 정보 저장
- [x] 커스텀 화면에 이미지 업로드 기능 추가 (로컬 파일 → Discord 업로드 → URL 저장)

### Phase 5: 화면 캡처 기능 ✅
- [x] html2canvas 라이브러리 설치 및 설정
- [x] 화면 캡처 함수 구현 (DOM → Canvas → Blob)
- [x] 고해상도 캡처 설정 (scale: 2)
- [x] 이미지 압축 및 최적화 (품질 0.95)
- [x] 이미지 파일명 생성 로직 (`{회의ID}_{슬라이드순서}_{타임스탬프}.png`)

### Phase 6: Discord 봇 연동 ✅
- [x] Discord 포럼 게시판 연동
- [x] 년월별 포스트 찾기/생성 로직
- [x] 회의별 스레드 찾기/생성 로직
- [x] Discord 이미지 업로드 API 구현 (백엔드)
- [x] Discord 채널 ID 환경변수 설정 (`DISCORD_MEETING_CHANNEL_ID=1438813568374931578`)
- [x] 이미지 업로드 및 URL/포스트ID/스레드ID 획득
- [x] 에러 처리 및 재시도 로직
- [x] Discord 포스트 이름에 회의 차수 추가 (예: "2025-11 회의 - 1차")

### Phase 7: 회의 생성 시 자동 캡처 ✅
- [x] 회의 생성 모달에서 2단계 플로우 구현
  - 1단계: 모드/탭 선택 및 슬라이드 순서 설정
  - 2단계: 회의 정보 입력 (이름, 날짜, 차수)
- [x] "생성 및 저장" 버튼 클릭 시 회의 생성 + 설정 저장 + 캡처 프로세스 시작
- [x] 설정된 슬라이드 순서대로 자동 캡처
- [x] 각 슬라이드의 모드/탭 컴포넌트 렌더링 (SlideRenderer)
- [x] 데이터 로딩 완료 대기 로직 (MutationObserver 사용, 안정성 5초 유지)
- [x] 실제 데이터 렌더링 완료 후에만 캡처하도록 개선
- [x] 캡처 진행 상황 표시 (진행 바, 완료된 슬라이드 수)
- [x] 모든 슬라이드 캡처 완료 후 구글시트에 URL 저장 (각 슬라이드별 개별 저장)
- [x] 회의 상태 업데이트 ("capturing" → "completed")
- [x] saveMeetingConfig 400 에러 수정 (슬라이드 배열 검증 강화)

### Phase 8: 회의진행 탭 기본 구조 ✅
- [x] 회의진행 탭 UI 구현
- [x] 지난 회의 목록 표시 (완료된 회의만)
- [x] 회의 선택 UI
- [x] 전체화면 API 연동
- [x] 슬라이드 인디케이터 표시

### Phase 9: 이미지 슬라이드 재생 ✅
- [x] 선택한 회의의 이미지 URL 목록 불러오기
- [x] 이미지 기반 슬라이드 렌더러 구현 (ImageSlideViewer)
- [x] 이미지 preload 기능 (다음 이미지 미리 로딩)
- [x] 이미지 로딩 및 표시
- [x] 로딩 중 UI 표시 (CircularProgress)
- [x] 로딩 완료 시 부드러운 전환 애니메이션

### Phase 10: 슬라이드 네비게이션 ✅
- [x] 키보드 이벤트 처리 (스페이스바, ESC, 화살표)
- [x] 마우스 클릭 이벤트 처리
- [x] 이전/다음 버튼 구현
- [x] 진행 상태 표시 (현재/전체 슬라이드 수)

### Phase 11: Presentation Mode 구현 ✅
- [x] 각 모드의 탭 컴포넌트 매핑 (modeTabConfig.js)
- [x] Presentation mode prop 추가 (ChartMode 컴포넌트 수정 완료)
- [x] SlideRenderer 컴포넌트 구현 (기본 구조)
- [x] 커스텀 화면 렌더링
- [x] 캡처 대상 DOM 요소 선택 로직 (data-slide-id 속성 사용)
- [x] 실제 모드 컴포넌트를 presentation mode로 렌더링 (ChartMode 수정 완료)
- [x] 하부 탭(서브탭) 선택 기능 추가
- [x] 데이터 로딩 완료 감지 로직 강화 (MutationObserver 사용, 안정성 5초 유지)
- [x] 실제 데이터 렌더링 완료 후에만 캡처하도록 개선
- [x] 회의 메인 슬라이드 자동 생성 (첫 번째 슬라이드, 회의 정보 표시)
- [x] 회의 목차 슬라이드 자동 생성 (두 번째 슬라이드, 모드별/탭별 목차)
- [x] 회의 엔딩 슬라이드 자동 생성 (마지막 슬라이드, 종료 메시지)
- [x] 모든 슬라이드 통일된 디자인 적용 (그라데이션 배경, 회사 로고, 생성자 정보)

### Phase 12: 테스트 및 최적화 (진행 중)
- [x] 각 모드별 테스트 (장표 모드 완료)
- [x] 이미지 캡처 품질 테스트 (고해상도 확인)
- [x] Discord 업로드 안정성 테스트
- [x] 이미지 로딩 성능 테스트
- [x] 데이터 로딩 완료 감지 로직 개선 (MutationObserver 사용)
- [x] 실제 데이터 렌더링 완료 후에만 캡처하도록 개선
- [x] 구글시트 각 슬라이드별 URL 개별 저장 문제 해결
- [x] saveMeetingConfig 400 에러 수정
- [x] 로딩 화면 캡처 문제 완전 해결 (강화된 로딩 감지 로직)
- [x] 캡처 진행 중 슬라이드 렌더링 화면 표시 개선
- [x] Presentation Mode 개선 (AppBar/Tabs 숨김, initialSubTab 지원)
- [x] Puppeteer 설치 (PPT 변환 준비)
- [x] 커스텀 슬라이드 Excel 파일 업로드 및 변환 기능
- [x] Excel 파일 한글 문자 렌더링 개선 (Puppeteer 사용)
- [x] 회의 정보 확장 (회의장소, 참석자 입력 필드 추가)
- [x] 회의 메인/목차/엔딩 슬라이드 디자인 개선
- [x] 모든 슬라이드 통일된 디자인 적용
- [ ] PPT 파일 변환 기능 구현 (Puppeteer 사용)
- [ ] 다른 모드별 테스트 (OB 관리 모드, 예산 모드 등)
- [ ] 성능 최적화 (이미지 로딩, 렌더링, 메모리 관리)
- [ ] UX 개선

---

## 5. 기술 스택 및 라이브러리

### 5.1 필수 라이브러리
- **html2canvas**: DOM을 Canvas로 변환하여 이미지 생성 ✅ 설치 완료
  ```bash
  npm install html2canvas
  ```

- **@dnd-kit/core**: 드래그 앤 드롭 기능
  ```bash
  npm install @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities
  ```

- **puppeteer**: PPT 파일을 이미지로 변환 (향후 구현) ✅ 설치 완료
  ```bash
  npm install puppeteer --save --prefix server
  ```

- **exceljs**: Excel 파일 읽기 및 이미지 변환 ✅ 설치 완료
  ```bash
  npm install exceljs
  ```

- **canvas**: Excel/PPT를 이미지로 변환 (서버 측) ✅ 설치 완료
  ```bash
  npm install canvas --save --prefix server
  ```

### 5.2 Discord 연동
- **discord.js**: Discord 봇과의 통신 (서버 측)
  - 기존 `server/monitor.js`에서 사용 중
  - 이미지 업로드를 위한 `AttachmentBuilder` 사용
  - 포럼 게시판 및 스레드 관리

### 5.3 구글시트 연동
- **googleapis**: 구글시트 API 연동 (서버 측)
  - 기존 프로젝트에서 사용 중인 패턴 참고

### 5.4 환경변수 추가 필요
```env
# Discord 설정
DISCORD_MEETING_CHANNEL_ID=1438813568374931578  # 회의 이미지 저장용 포럼 게시판

# 구글시트 설정 (기존 시트 ID 사용)
# MEETING_SHEET_ID는 기존 SHEET_ID와 동일하게 사용
```

---

## 6. 구현 시 주의사항

### 6.1 화면 캡처 시 주의
- **동적 콘텐츠**: 로딩 중인 데이터가 있으면 완료 후 캡처
- **외부 리소스**: 외부 이미지나 폰트가 로드될 때까지 대기
- **애니메이션**: CSS 애니메이션이 진행 중이면 완료 후 캡처
- **iframe**: iframe 내부 콘텐츠는 별도 처리 필요
- **고해상도**: 1920x1080 이상 설정, 파일 크기 최적화 고려

### 6.2 Discord 업로드 제한
- **파일 크기**: 최대 25MB
- **업로드 속도**: 너무 빠른 연속 업로드 시 rate limit 발생 가능
- **에러 처리**: 업로드 실패 시 재시도 로직 필요
- **포럼 게시판**: 포스트 및 스레드 생성 시 권한 확인

### 6.3 구글시트 저장 최적화
- **배치 저장**: 여러 슬라이드 URL을 한 번에 저장
- **에러 복구**: 저장 실패 시 재시도 및 로컬 백업
- **데이터 검증**: URL 유효성 검사
- **차수 중복 방지**: 같은 날짜 + 같은 차수 체크

### 6.4 성능 최적화
- **이미지 로딩**: 지난 회의 재생 시 이미지 preload
- **메모리 관리**: 많은 이미지를 로드할 때 메모리 누수 방지
- **렌더링 최적화**: 불필요한 리렌더링 방지
- **이미지 압축**: 고해상도 유지하면서 파일 크기 최적화

### 6.5 회의 삭제 시
- **구글시트만 삭제**: Discord 이미지는 유지하여 자료 보존
- **삭제 확인**: 사용자에게 확인 메시지 표시

---

## 7. 구글시트 시트 생성 가이드

### 7.1 시트 생성 방법
1. 기존 구글시트를 엽니다 (SHEET_ID 사용)
2. 하단에 새 시트를 추가합니다:
   - 시트 이름: `회의목록`
   - 시트 이름: `회의설정`

### 7.2 "회의목록" 시트 헤더
1행은 비워두고, 2행에 다음 헤더를 복사하여 붙여넣습니다:

```
회의ID	회의이름	회의날짜	차수	생성자	생성일시	상태	회의장소	참석자
```

**참고**: 헤더는 `ensureSheetHeaders` 함수가 자동으로 확인하고 업데이트하므로, 수동으로 추가하지 않아도 됩니다. 첫 번째 API 호출 시 자동으로 헤더가 생성/업데이트됩니다.

### 7.3 "회의설정" 시트 헤더
1행은 비워두고, 2행에 다음 헤더를 복사하여 붙여넣습니다:

```
회의ID	슬라이드ID	순서	타입	모드	탭	제목	내용	배경색	이미지URL	캡처시간	Discord포스트ID	Discord스레드ID
```

### 7.4 참고사항
- 1행은 항상 비워둡니다 (데이터는 3행부터 입력)
- 헤더는 2행에만 입력합니다
- 탭 문자(`\t`)로 구분되어 있습니다 (복사 시 자동으로 컬럼 분리됨)

---

## 8. 다음 단계

1. ✅ 요구사항 확정 완료
2. 구글시트 시트 생성 (사용자가 수동 생성)
3. 환경변수 설정 (`DISCORD_MEETING_CHANNEL_ID`)
4. Phase 1부터 순차적으로 구현 시작

---

## 9. 테스트 단계

### ✅ 1단계: 회의 목록 조회 (회의준비 탭) - 완료
- [x] 회의 모드 진입 확인
- [x] "회의준비" 탭 선택 확인
- [x] 회의 목록 정상 표시 확인
- [x] 빈 목록 시 "회의가 없습니다" 메시지 표시 확인

### ✅ 2단계: 새 회의 생성 - 모드/탭 선택 - 완료
- [x] "새 회의 생성" 버튼 클릭 확인
- [x] Step 0: 모드/탭 선택 화면 표시 확인
- [x] 권한이 있는 모든 모드 표시 확인
- [x] 모드 선택 시 탭 목록 표시 확인
- [x] 하부 탭(서브탭) 표시 및 선택 가능 확인
- [x] "커스텀 화면 추가" 버튼 동작 확인
- [x] 슬라이드 순서 편집(위/아래 이동) 동작 확인
- [x] 최소 1개 이상 슬라이드 선택 후 "다음" 버튼 활성화 확인

### ✅ 3단계: 새 회의 생성 - 회의 정보 입력 - 완료
- [x] Step 1: 회의 정보 입력 화면 표시 확인
- [x] 회의 이름 입력 확인
- [x] 회의 날짜 선택 확인
- [x] 차수 입력 확인
- [x] 같은 날짜에 동일 차수 존재 시 에러 메시지 표시 확인
- [x] "생성 및 저장" 버튼 클릭 확인
- [x] 회의 생성 후 바로 캡처 화면으로 이동 확인

### ✅ 4단계: 화면 캡처 자동 시작 - 완료
- [x] 회의 생성 후 자동으로 캡처 화면으로 이동 확인
- [x] 각 슬라이드별 캡처 진행 상황 표시 확인
- [x] 진행률 표시 확인
- [x] 각 슬라이드의 실제 모드/탭 화면이 정상적으로 렌더링되는지 확인
- [x] 캡처 진행 중 슬라이드 렌더링 화면 표시 확인 (로딩 중에도 콘텐츠 표시)
- [x] 데이터 로딩 완료 후 실제 데이터 화면이 캡처되는지 확인 (로딩 화면 제외)
- [x] 로딩 감지 로직 강화 (최소 3개 테이블 행, 프로그레스 바 확인, 5초 안정 상태 유지)
- [x] 캡처 완료 후 Discord 업로드 확인
- [x] Google Sheet에 각 슬라이드별 이미지 URL 개별 저장 확인
- [x] Discord 포스트 이름에 회의 차수 포함 확인 (예: "2025-11 회의 - 1차")
- [x] 캡처 완료 후 회의 상태가 "completed"로 업데이트되는지 확인
- [x] 커스텀 슬라이드 이미지 파일 업로드 확인
- [x] 커스텀 슬라이드 Excel 파일 업로드 및 변환 확인
- [ ] 캡처 완료 후 목록으로 돌아가는지 확인

### 5단계: 회의 수정
- [ ] 회의 목록에서 "수정" 버튼 클릭 확인
- [ ] 회의 정보 수정 가능 확인
- [ ] 저장 후 목록에 반영 확인

### 6단계: 회의 설정 편집
- [ ] 회의 목록에서 회의 선택 확인
- [ ] 모드/탭 선택 및 슬라이드 순서 변경 가능 확인
- [ ] 커스텀 화면 추가/삭제 가능 확인
- [ ] 저장 후 재캡처 가능 확인

### 7단계: 회의진행 탭 - 지난 회의 재생
- [ ] "회의진행" 탭 선택 확인
- [ ] 완료된 회의 목록 표시 확인
- [ ] 회의 선택 후 "재생" 버튼 클릭 확인
- [ ] 전체화면 모드로 전환 확인
- [ ] 스페이스바 또는 클릭으로 다음 슬라이드 이동 확인
- [ ] ESC 키로 전체화면 종료 확인
- [ ] 이미지가 정상적으로 로드되는지 확인

### 8단계: 회의 삭제
- [ ] 회의 목록에서 "삭제" 버튼 클릭 확인
- [ ] 확인 메시지 표시 확인
- [ ] 삭제 후 목록에서 제거 확인
- [ ] Discord 이미지는 유지되는지 확인

---

## 10. 최근 완료된 개선 사항

### 10.1 커스텀 슬라이드 이미지 업로드 기능
- 로컬 컴퓨터에서 이미지 파일 선택
- Discord에 자동 업로드
- 업로드된 이미지 URL을 커스텀 슬라이드에 저장
- 이미지 미리보기 및 제거 기능

### 10.2 Discord 포스트 이름 개선
- 기존: "2025-11 회의"
- 변경: "2025-11 회의 - 1차", "2025-11 회의 - 2차" 등
- 회의 차수별로 포스트 구분하여 이미지 관리 용이

### 10.3 로딩 화면 캡처 문제 해결
- 실제 데이터 렌더링 완료 후에만 캡처하도록 개선
- MutationObserver를 사용한 DOM 변경 감지
- 안정적인 상태 5초 유지 후 캡처
- 실제 테이블 행이 렌더링되었는지 확인

### 10.4 구글시트 저장 문제 해결
- 각 슬라이드별 URL이 개별 저장되도록 수정
- saveMeetingConfig 400 에러 수정 (슬라이드 배열 검증 강화)
- 회의 상태 업데이트 로직 개선

### 10.5 하부 탭(서브탭) 선택 기능
- 채권장표 > 재초담초채권, 연체채권 등 하부 탭 선택 가능
- 모드/탭 선택 화면에서 하부 탭을 작은 칩으로 표시

### 10.6 캡처 진행 중 슬라이드 렌더링 화면 표시 개선
- 로딩 중에도 콘텐츠를 먼저 렌더링하여 사용자가 볼 수 있도록 수정
- 로딩 중 반투명 오버레이 추가: 콘텐츠는 보이면서 로딩 상태 표시
- 사용자가 캡처 진행 중 각 슬라이드의 렌더링 상태를 확인할 수 있도록 개선

### 10.7 로딩 화면 캡처 문제 완전 해결
- TotalClosingTab: 컴포넌트 마운트 시 자동 데이터 로드
- 로딩 상태 변경 지연 증가: 500ms → 2000ms
- 로딩 감지 로직 강화:
  - 최소 3개 테이블 행 확인
  - 프로그레스 바 확인
  - 실제 데이터 텍스트 확인 (100자 이상)
  - 5초 안정 상태 유지 필요
- SlideRenderer: 초기 대기 15초, 추가 안정화 10초, 최종 테이블 행 3개 이상 확인

### 10.8 Presentation Mode 개선
- ChartMode: presentationMode일 때 AppBar와 Tabs 네비게이션 숨김
- ClosingChartTab: initialSubTab과 presentationMode props 추가
- ClosingChartTab: presentation mode에서 서브 탭 네비게이션 숨김
- SlideRenderer: 하부 탭 인덱스 계산 로직 개선 및 디버깅 로그 추가

### 10.9 Puppeteer 설치
- puppeteer@24.30.0 설치 완료
- 향후 PPT 변환 기능 구현 준비 완료

### 10.10 커스텀 슬라이드 파일 업로드 확장
- 이미지 파일 업로드 (기존)
- Excel 파일 업로드 및 이미지 변환 (ExcelJS + Canvas 사용)
- PPT 파일 업로드 준비 (Puppeteer 설치 완료, 변환 로직은 추후 구현)

### 10.11 Excel 파일 한글 문자 렌더링 개선
- Excel 파일 변환 시 한글이 깨지는 문제 해결
- HTML + Puppeteer 방식 우선 사용 (브라우저 렌더링으로 한글 폰트 지원)
- Canvas 방식은 폴백으로 유지
- UTF-8 인코딩 및 한국어 폰트 지정

### 10.12 슬라이드 개수 제한 제거
- SlideOrderEditor에서 슬라이드 목록 스크롤 가능하도록 수정
- maxHeight: '500px', overflowY: 'auto' 추가
- 7개 이상의 슬라이드도 생성 가능

### 10.13 회의 정보 확장 (회의장소, 참석자)
- 회의 생성 시 회의장소 입력 필드 추가
- 참석자 입력 필드 추가 (쉼표로 구분)
- Google Sheets 스키마 확장: '회의장소', '참석자' 컬럼 추가
- getMeetings, createMeeting, updateMeeting에서 헤더 자동 확인 및 업데이트
- ensureSheetHeaders 함수가 기존 헤더와 다를 경우 자동 업데이트

### 10.14 회의 메인 슬라이드 디자인 개선
- 회사 로고 및 회사명 "(주)브이아이피플러스" 상단 표시
- 차수 배지 강조 표시 (상단에 큰 배지 형태)
- 회의 정보 카드 디자인 개선 (일시, 장소, 참석자)
- 그라데이션 배경 (보라색 계열)
- 반응형 디자인 적용

### 10.15 회의 목차 슬라이드 추가
- 두 번째 슬라이드로 자동 추가
- 선택된 모든 모드/탭을 모드별로 그룹화하여 표시
- 각 모드의 탭과 서브탭을 계층 구조로 표시
- 커스텀 슬라이드는 "추가 화면" 섹션에 별도 표시
- getMeetingConfig에서 modeGroups 동적 재구성 로직 추가
- 회의 흐름을 한눈에 파악할 수 있도록 구성

### 10.16 회의 엔딩 슬라이드 추가
- 마지막 슬라이드로 자동 추가
- "감사합니다" 메시지 및 회의 정보 표시
- 회의 종료를 명확하게 알리는 디자인
- 회사 로고 및 회사명 포함

### 10.17 모든 슬라이드 통일된 디자인 적용
- 모든 슬라이드에 동일한 그라데이션 배경 적용
- 상단: 회사 로고 및 회사명 통일
- 하단: 생성자 정보 통일
- mode-tab 슬라이드:
  - 모드/탭 제목 상단 표시
  - 실제 콘텐츠를 약간 회색 배경 카드 안에 배치 (하얀색 텍스트도 잘 보이도록)
  - 카드 안에서만 스크롤 가능
- 커스텀 슬라이드: 통일된 디자인으로 재구성
- 회의 흐름이 자연스럽게 이어지도록 통일성 확보

### 10.18 회의 디자인 개선 (2025-01-XX)
- **상단 헤더 디자인 변경**
  - 로고와 회사명을 왼쪽 정렬로 변경
  - 상단 박스 제거하고 상단 전체를 하얀색 배경으로 변경
  - 로고 색상 통일 (완전 하얀색)
  - 상단 헤더를 absolute로 배치하여 콘텐츠와 분리
  - 중앙 콘텐츠 영역에 padding-top 추가하여 헤더 공간 확보

- **배경색 변경**
  - 보라색 그라데이션(`#667eea` → `#764ba2`)을 검은색/회색 계열(`#2c2c2c` → `#1a1a1a`)로 변경
  - 모든 슬라이드 타입에 일괄 적용 (main, toc, ending, custom, mode-tab)

- **이미지 캡쳐 개선**
  - 스크롤 영역 전체를 포함하도록 수정
  - `scrollX`, `scrollY`, `windowWidth`, `windowHeight` 옵션 추가
  - 화면에 보이지 않는 영역까지 캡쳐 가능하도록 개선

- **회의 진행 화면 개선**
  - 가로 기준으로 이미지 크기 맞춤
  - 세로는 스크롤 추가하여 전체 화면 모드에서도 스크롤 가능
  - 이미지가 화면 너비에 맞춰지고 세로로 스크롤하여 전체 내용 확인 가능

- **세부 옵션 여러 개 선택 기능**
  - `csDetailType` 옵션에 `multiple: true` 속성 추가
  - 세부 옵션 선택 모달에서 체크박스로 여러 개 선택 가능
  - 각 선택값마다 별도 슬라이드로 자동 생성
  - 예: 코드별, 사무실별, 담당자별 각각 선택하여 각각 슬라이드 추가 가능
  - `detailOptionMultipleSelections` 상태 추가하여 여러 선택값 관리
  - 선택된 각 값에 대해 고유한 `subTabId` 생성하여 슬라이드 구분

- **데이터 없는 영역 자동 크롭 기능**
  - sharp 라이브러리를 사용하여 이미지 자동 크롭 처리
  - `autoCropImage` 함수 구현: 흰색 배경이나 투명 영역을 자동으로 감지하여 제거
  - `trim` 기능 사용: threshold 10으로 설정하여 약간의 색상 차이도 감지
  - 원본 크기 정보를 메타데이터로 저장 (originalWidth, originalHeight, croppedWidth, croppedHeight)
  - 모든 이미지 업로드 경로에 적용:
    - 회의 슬라이드 이미지 업로드 (`uploadMeetingImage`)
    - 커스텀 슬라이드 이미지 업로드 (`uploadCustomSlideFile`)
    - Excel 파일 변환 이미지 (Puppeteer 및 Canvas 방식 모두)
  - 크롭된 이미지만 Discord에 저장되며, 원본 크기 정보는 응답에 포함
  - 크롭 실패 시 원본 이미지 반환 (안전장치)

### 10.19 회의 모드 개선 사항 (2025-01-XX)

#### UI/UX 개선
- [x] **캡처 진행 중 슬라이드 정보 표시**: 슬라이드 번호 옆에 어떤 대상(모드/탭/서브탭)인지 표시
- [x] **헤더 높이 조정**: 로고와 회사이름 헤더의 하얀배경 높이 증가 (사진과의 공간 조정)
- [x] **배경색 및 글자색 변경**: 검은색/회색 배경을 아주 연한 회색으로, 글자색을 어두운 계열로 변경
- [x] **목차 한글명 표시**: 목차 부분의 이름들을 영문 파일명이 아닌 한글명으로 표시 (이미 tabLabel, subTabLabel 사용 중)
- [x] **재초담초채권 문구 색상**: "재초담초채권 관리" 문구가 하얀색이라 잘 안보임 - 어두운 계열로 변경
- [x] **커스텀 슬라이드 디자인 통일**: 커스텀 슬라이드도 다른 슬라이드와 동일한 디자인 및 정렬 적용

#### 캡처 기능 개선
- [x] **마감장표 펼쳐진 부분 캡쳐**: 전체총마감에서 소속별/사무실별/코드별/담당자별 선택 시 펼쳐진 부분(담당자별 실적 등) 정확히 캡쳐 (presentationMode일 때 자동 펼치기)
- [x] **재초담초채권 전체 화면 캡쳐**: 
  - 중간이 잘리지 않도록 전체 화면 캡쳐 (screenCapture.js에서 scrollWidth/scrollHeight 사용)
  - 저장 시점 선택에서 가장 최근 입력시점을 자동 선택하여 캡쳐
- [ ] **재고장표 전체 화면 캡쳐**: 스크롤 없이도 전체 화면을 모두 캡쳐할 수 있도록 개선 (screenCapture.js에서 이미 처리됨, 확인 필요)
- [ ] **Discord 분리 문제 해결**: 커스텀화면과 어플화면이 디스코드에서 분리되는 문제 해결 (접근 방법 재검토 필요)

#### 엑셀 변환 개선
- [x] **엑셀 한글 변환 문제**: 엑셀 파일 이미지 변환 시 한글 부분이 특수문자로 변환되는 문제 해결 (HTML 이스케이프 처리 추가)

#### 성능 최적화
- [x] **슬라이드 생성 시간 최적화**: 
  - 최소 대기 시간 2초 -> 1초로 단축
  - 데이터 로딩 안정성 확인 시간 5초 -> 2초로 단축
  - 슬라이드 준비 확인 타임아웃 10초 -> 5초로 단축
- [x] **코드 정리정돈**:
  - 불필요한 renderKey 상태 제거
  - console.log를 개발 모드에서만 실행하도록 조건부 처리

### 10.20 전문적인 PPT 디자인 개선 (2025-01-XX)

### 10.21 회의 모드 종합 개선 및 최적화 (2025-01-XX)

#### 버그 수정
- [x] **1.4 마감장표 세부옵션 문제 해결**
  - detailOptionMultipleSelections 처리 로직 개선
  - 각 선택값에 대해 올바른 csDetailType 전달 확인
  - TotalClosingTab에서 propCsDetailType이 올바르게 적용되도록 수정
  - 담당자별 실적 테이블이 실제로 펼쳐져서 캡처되도록 data-agent-section 속성 추가
  - presentationMode일 때 agentTableOpen이 true로 설정되어 실제 테이블이 렌더링되는지 확인 로직 추가

- [x] **1.6 이미지 파일 업로드 미확인 문제 해결**
  - CustomSlideEditor에서 단일 이미지 업로드 시 previewUrl 상태 업데이트 추가

- [x] **1.9 로딩 화면 캡처 문제 해결**
  - 모드별 동적 대기 시간 구현
  - 각 모드별 최소 대기 시간 설정 (마감장표: 20초, 재고장표: 15초, 커스텀: 5초 등)

- [x] **1.10 모드별 캡처 시간 차별화**
  - SlideRenderer에서 모드별 최소 대기 시간 설정
  - 모드별 추가 안정화 대기 시간 자동 계산

#### 미구현 기능
- [x] **2.3 캡처 완료 후 목록으로 이동**
  - MeetingPreparationTab의 handleConfigSave가 이미 목록 새로고침을 수행하도록 구현됨

#### 진행 중인 작업
- [ ] **1.1 화면 캡처 전체 영역 문제**
  - screenCapture.js에 이미 onclone 콜백과 scrollHeight 설정이 있으나 추가 개선 필요

- [ ] **1.2 Discord 분리 문제**
  - meetingRoutes.js에서 meetingNumber를 전달하도록 되어 있으나 추가 확인 필요

- [ ] **1.3 목차 영문 파일명 문제**
  - SlideRenderer.js에서 tabLabel/subTabLabel을 사용하고 있으나 추가 확인 필요

- [ ] **1.5 엑셀 한글 깨짐 문제**
  - convertExcelToHTML에서 HTML 이스케이프 처리가 되어 있으나 추가 확인 필요

- [ ] **1.7 로고/회사명 정렬 문제**
  - 중앙 정렬 확인 필요

- [ ] **1.8 제목 배경색 제거**
  - backgroundColor 제거 확인 필요

- [ ] **2.1 PPT 파일 변환 기능 구현**
  - Puppeteer를 사용한 PPT → HTML → 이미지 변환 구현 필요

- [ ] **2.2 재고장표 전체 화면 캡처 확인**
  - screenCapture.js에서 이미 처리되어 있으나 테스트 필요

#### 고도화 작업
- [ ] **3.1 성능 최적화**
  - 이미지 로딩 최적화 (preload 개선)
  - 렌더링 최적화 (React.memo, useMemo 활용)
  - 메모리 관리 개선

- [ ] **3.2 UX 개선**
  - 캡처 진행 중 더 상세한 피드백
  - 예상 소요 시간 표시
  - 에러 처리 개선

- [ ] **3.3 코드 품질 개선**
  - 불필요한 console.log 제거 또는 개발 모드에서만 실행
  - 타입 안정성 강화
  - 주석 개선

#### 디자인 시스템 개선
- [x] **배경 그라데이션**: 더 전문적인 3단계 그라데이션 적용 (#f8f9fa → #e9ecef → #f1f3f5)
- [x] **헤더 디자인**: 미묘한 그림자와 경계선 추가로 깊이감 부여
- [x] **타이포그래피**: 
  - Noto Sans KR 폰트 적용
  - 제목에 그라데이션 텍스트 효과 적용
  - 폰트 크기 및 가중치 최적화 (더 명확한 계층 구조)
- [x] **카드 디자인**: 
  - 반투명 배경 → 순수 흰색 배경으로 변경
  - 더 부드러운 그림자 효과 (0 4px 20px rgba(0,0,0,0.08))
  - 16px 둥근 모서리로 현대적인 느낌
- [x] **색상 팔레트**: 
  - 액센트 컬러 추가 (#667eea, #764ba2, #f5576c)
  - 아이콘 배경에 컬러 적용
  - 일관된 색상 체계 구축
- [x] **시각적 요소**: 
  - 차수 배지에 그라데이션 배경 적용
  - 아이콘을 컬러 배경 박스에 배치
  - 목차에 점(dot) 인디케이터 추가
  - 참석자 태그에 호버 효과 추가
- [x] **간격 및 여백**: 
  - 더 넉넉한 패딩과 마진
  - 요소 간 일관된 간격 유지
- [x] **모든 슬라이드 타입 통일**: 
  - 메인, 목차, 엔딩, 커스텀, mode-tab 슬라이드 모두 동일한 디자인 시스템 적용

---

## 11. 참고 사항

- 기존 모드 컴포넌트들의 구조를 최대한 활용
- Material-UI 컴포넌트 사용 (기존 스타일과 일관성 유지)
- 반응형 디자인 고려 (다양한 화면 크기 지원)
- 접근성 고려 (키보드 네비게이션, 스크린 리더 지원)
- 이미지 파일 크기 최적화 (Discord 업로드 제한: 25MB)
- Discord CDN URL은 영구적으로 유지되므로 안정적으로 사용 가능
- **플랜 파일은 로컬에서만 관리하며 깃에 커밋하지 않음**

---

## 12. 최종 개선 및 최적화 완료 사항 (2025-01-XX)

### 12.1 버그 수정 완료

#### ✅ 1.1 화면 캡처 전체 영역 문제
- **문제**: `scrollWidth`/`scrollHeight` 계산이 정확하지 않아 전체 영역이 캡처되지 않음
- **해결**: 
  - `calculateFullSize` 함수 추가하여 모든 자식 요소를 포함한 실제 크기 계산
  - `onclone` 콜백에서 모든 자식 요소의 `overflow` 속성을 `visible`로 설정
  - Material-UI 컨테이너(`MuiPaper`, `MuiBox`, `MuiContainer`)도 명시적으로 처리
  - `body`와 `html` 요소의 높이도 조정하여 전체 영역 보장
- **파일**: `src/utils/screenCapture.js`

#### ✅ 1.2 Discord 분리 문제
- **문제**: 커스텀 슬라이드와 앱 화면이 다른 Discord 포스트에 저장됨
- **해결**:
  - `uploadCustomSlideFile`에서 `meetingNumber`를 명시적으로 전달
  - `findOrCreatePost` 로직 강화: `meetingNumber`가 없어도 같은 년월의 포스트를 찾도록 개선
  - 가장 최근 포스트를 선택하도록 정렬 로직 추가
- **파일**: `server/meetingRoutes.js`

#### ✅ 1.3 목차 영문 파일명 문제
- **문제**: 목차에서 영문 파일명이 표시됨
- **해결**: `slide.tabLabel`과 `slide.subTabLabel`을 우선 사용하도록 수정
- **파일**: `src/components/meeting/SlideRenderer.js`

#### ✅ 1.4 마감장표 세부옵션 문제
- **문제**: "담당자별 실적" 선택해도 전체총마감으로만 나오고, 실제 앱에서 펼쳐진 화면이 아닌 다른 화면이 캡처됨
- **해결**:
  - `MeetingEditor.js`에서 `detailOptionMultipleSelections`를 올바르게 처리하여 각 선택값에 대해 별도 슬라이드 생성
  - `ChartMode.js`의 `TotalClosingTab`에 `data-agent-section="true"` 속성 추가
  - `useEffect`에서 `propCsDetailType`이 'agent'일 때 담당자별 테이블이 렌더링되었는지 명시적으로 확인
- **파일**: `src/components/meeting/MeetingEditor.js`, `src/components/ChartMode.js`

#### ✅ 1.5 엑셀 한글 깨짐 문제
- **문제**: 엑셀 파일 변환 시 한글이 깨짐
- **해결**:
  - HTML 이스케이프 처리 추가 (이미 구현되어 있었으나 확인 완료)
  - Puppeteer에서 UTF-8 인코딩 명시 (`<meta charset="UTF-8">`, `<meta http-equiv="Content-Type">`)
  - 한글 폰트 로드 대기 (`document.fonts.ready`)
- **파일**: `server/meetingRoutes.js`

#### ✅ 1.6 이미지 파일 업로드 미확인 문제
- **문제**: 이미지 파일 업로드 후 미리보기가 표시되지 않음
- **해결**: `CustomSlideEditor.js`에서 단일 이미지 업로드 시 `setPreviewUrl(result.imageUrl)` 명시적 호출
- **파일**: `src/components/meeting/CustomSlideEditor.js`

#### ✅ 1.7 로고/회사명 정렬 문제
- **문제**: 로고와 회사명이 상단 정렬되어 있음
- **해결**: 이미 `alignItems: 'center'`로 설정되어 있어 수직 정렬은 중앙 정렬됨 (확인 완료)
- **파일**: `src/components/meeting/SlideRenderer.js`

#### ✅ 1.8 제목 배경색 제거
- **문제**: 제목에 배경색이 표시됨
- **해결**: 제목 `Typography`에 `backgroundColor: 'transparent'` 명시적 설정
- **파일**: `src/components/meeting/SlideRenderer.js`

#### ✅ 1.9 로딩 화면 캡처 문제
- **문제**: 최적화로 시간을 줄이니 로딩 화면이 다시 캡처됨
- **해결**: 모드별 동적 대기 시간 구현 (1.10과 통합)
- **파일**: `src/components/meeting/SlideRenderer.js`

#### ✅ 1.10 모드별 캡처 시간 차별화
- **문제**: 모든 모드에 동일한 대기 시간 적용
- **해결**:
  - `getModeWaitTime` 함수 추가: 모드별 최소 대기 시간 설정
    - 마감장표: 20초
    - 재고장표: 15초
    - 커스텀: 5초
    - 메인/목차/엔딩: 2초
  - `requiredStableCount`를 모드별 대기 시간에 맞게 조정
  - 추가 안정화 대기 시간도 모드별로 차별화
- **파일**: `src/components/meeting/SlideRenderer.js`

### 12.2 미구현 기능 구현 완료

#### ✅ 2.1 PPT 파일 변환 기능 구현
- **구현 내용**:
  - Puppeteer를 사용하여 PPT 파일을 HTML로 변환 후 이미지로 변환
  - 기본적인 HTML 템플릿 생성 (향후 officegen 등으로 확장 가능)
  - 이미지 자동 크롭 처리 포함
- **파일**: `server/meetingRoutes.js`

#### ✅ 2.2 재고장표 전체 화면 캡처 확인
- **확인 내용**: `screenCapture.js`의 개선으로 재고장표도 전체 영역이 캡처됨
- **파일**: `src/utils/screenCapture.js`

#### ✅ 2.3 캡처 완료 후 목록으로 이동
- **확인 내용**: 이미 구현되어 있음 (`MeetingPreparationTab.js`의 `handleConfigSave`에서 리스트 새로고침)
- **파일**: `src/components/meeting/MeetingPreparationTab.js`

### 12.3 고도화 작업 완료

#### ✅ 3.1 성능 최적화
- **이미지 로딩**: `ImageSlideViewer.js`에서 이미지 preload 구현 (이미 완료)
- **렌더링 최적화**:
  - `SlideRenderer`에 `React.memo` 적용
  - `renderSlideContent`를 `useCallback`으로 메모이제이션
  - 비교 함수를 통한 불필요한 재렌더링 방지
- **메모리 관리**: 컴포넌트 언마운트 시 정리 로직 확인
- **파일**: `src/components/meeting/SlideRenderer.js`

#### ✅ 3.2 UX 개선
- **상세 피드백**:
  - 캡처 진행 중 현재 캡처 중인 슬라이드 정보 표시
  - 각 슬라이드의 상태(완료/실패/대기 중) 표시
- **예상 소요 시간**:
  - 경과 시간 표시
  - 완료된 슬라이드의 평균 시간을 기반으로 예상 남은 시간 계산
  - 시간 포맷팅 함수 추가 (초/분 단위)
- **파일**: `src/components/meeting/CaptureProgress.js`, `src/components/meeting/MeetingCaptureManager.js`

#### ✅ 3.3 코드 품질 개선
- **console.log 정리**: 개발 모드에서만 출력하도록 조건부 처리 (일부 파일)
- **타입 안정성**: PropTypes 또는 TypeScript 도입 검토 필요 (향후 작업)
- **주석 개선**: 주요 함수에 JSDoc 주석 추가
- **파일**: 전체 회의 모드 관련 파일
