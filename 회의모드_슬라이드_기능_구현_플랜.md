# 회의 모드 슬라이드 기능 구현 플랜

> 회의 모드에 회의준비 탭과 회의진행 탭을 추가하여, 관리자 모드의 화면들을 슬라이드 형태로 순서대로 보여주는 기능을 구현합니다.
> 
> **중요**: 이 플랜 파일은 로컬에서만 관리하며, 깃에 커밋하지 않습니다.

---

## 1. 기능 개요

### 1.1 목적
- 회의 중 관리자 모드의 각 화면을 PPT처럼 순서대로 전체화면으로 보여주기
- 회의 전에 보여줄 모드와 탭을 선택하고 순서를 설정할 수 있도록 함
- 회의 생성 시 자동으로 화면을 캡처하여 차수별로 관리
- 지난 회의의 캡처된 화면을 재생하여 당시 상태 확인

### 1.2 주요 기능
1. **회의준비 탭**: 회의에 사용할 모드/탭 선택 및 순서 설정, 회의 목록 관리
2. **회의 생성 및 자동 캡처**: 회의 생성 시 설정된 화면들을 자동으로 캡처하여 Discord에 저장
3. **회의진행 탭**: 지난 회의 선택 시 캡처된 이미지로 슬라이드 재생
4. **슬라이드 네비게이션**: 스페이스바/클릭으로 다음 화면, ESC로 종료
5. **추가 화면 기능**: 중간에 커스텀 화면 추가 가능
6. **회의 이력 관리**: 차수별로 지난 회의 목록 조회 및 재생

---

## 2. 상세 요구사항

### 2.1 회의준비 탭

#### 2.1.1 모드/탭 선택 기능
- **사용 가능한 모드 목록 표시**
  - 현재 사용자의 `loggedInStore.modePermissions`에서 권한이 있는 모드만 표시
  - 각 모드의 타이틀과 아이콘 표시 (modeConfig.js 참조)
  - 예: OB 관리 모드, 장표 모드, 예산 모드, 검수 모드 등

- **각 모드의 탭 목록 표시**
  - 선택한 모드에 따라 해당 모드의 탭 목록을 동적으로 표시
  - 예: OB 관리 모드 선택 시 → "투게더 계산기", "OB 정산 확인", "OB 정산 관리"
  - 예: 장표 모드 선택 시 → "마감장표", "채권장표", "지표장표", "재고장표"
  - 권한이 없는 탭은 표시하지 않음

- **체크박스로 선택**
  - 각 탭에 체크박스 제공
  - 여러 모드의 여러 탭을 동시에 선택 가능

#### 2.1.2 순서 설정 기능
- **드래그 앤 드롭으로 순서 변경**
  - 선택된 탭들을 리스트로 표시
  - 드래그 앤 드롭으로 순서 변경 가능
  - 또는 위/아래 화살표 버튼으로 순서 조정

- **순서 표시**
  - 각 항목에 순서 번호 표시 (1, 2, 3, ...)
  - 모드명과 탭명을 함께 표시 (예: "OB 관리 모드 > OB 정산 확인")

#### 2.1.3 추가 화면 기능
- **커스텀 화면 추가**
  - 중간에 추가할 수 있는 빈 화면 또는 텍스트 화면
  - 예: "회의 안내", "질의응답 시간", "다음 주제로 이동" 등
  - 추가 화면도 순서에 포함되어 드래그 앤 드롭으로 위치 변경 가능

- **추가 화면 편집**
  - 제목, 내용, 배경색 등을 설정 가능
  - 간단한 마크다운 또는 HTML 지원 검토

#### 2.1.4 회의 목록 관리
- **회의 생성 및 목록 표시**
  - 회의 이름, 날짜, 차수(수동 입력) 등을 입력하여 새 회의 생성
  - 생성된 회의 목록을 테이블/카드 형태로 표시
  - 차수별로 정렬 (최신순/과거순)
  - 지난 회의와 예정된 회의 구분 표시
  - **차수 중복 방지**: 같은 날짜에 동일 차수가 이미 존재하면 경고 및 생성 방지

- **회의 생성 시 자동 캡처**
  - 회의 생성 버튼 클릭 시 설정된 모든 슬라이드를 순서대로 자동 캡처
  - 각 슬라이드의 실제 모드/탭 화면을 렌더링하여 캡처
  - 캡처 완료 후 Discord에 업로드 및 구글시트에 URL 저장
  - 캡처 진행 상황 표시 (진행 바, 완료된 슬라이드 수 등)

- **회의 선택 및 편집**
  - 목록에서 회의 선택 시 해당 회의의 설정(모드/탭/순서) 불러오기
  - 회의 정보 수정 가능 (이름, 날짜 등)
  - 회의 삭제 기능 (구글시트에서만 삭제, Discord 이미지는 유지)

- **회의 설정 저장**
  - 선택한 모드/탭과 순서를 구글시트에 저장
  - 회의별로 독립적인 설정 관리
  - 회의 ID를 통한 고유 식별

---

### 2.2 회의진행 탭

#### 2.2.1 회의 선택
- **회의 목록 표시**
  - 회의진행 탭에서 지난 회의 목록 표시
  - 회의 이름, 날짜, 차수, 생성자 정보 표시
  - 차수별로 정렬

- **회의 선택 및 재생**
  - 목록에서 회의 선택 시 해당 회의의 캡처된 이미지들을 슬라이드 형태로 재생
  - 실제 모드 컴포넌트가 아닌 이미지로 표시 (당시 화면 보존)

#### 2.2.2 이미지 슬라이드 재생
- **이미지 로딩 및 표시**
  - 구글시트에서 해당 회의의 이미지 URL 목록 불러오기
  - 이미지 preload (다음 이미지 미리 로딩)
  - 순서대로 이미지를 전체화면으로 표시
  - 로딩 중 스피너 및 진행 상태 표시

- **전체화면 모드**
  - 이미지 슬라이드 재생 시 전체화면 모드 진입
  - 브라우저 전체화면 API 사용 (Fullscreen API)
  - 상단/하단 네비게이션 바 숨김

#### 2.2.3 네비게이션 기능
- **다음 화면 이동**
  - 스페이스바 키 입력 시 다음 화면으로 이동
  - 마우스 클릭 시 다음 화면으로 이동
  - 화면 하단에 "다음" 버튼 표시 (선택사항)

- **이전 화면 이동**
  - 좌측 화살표 키 또는 백스페이스로 이전 화면 이동
  - 화면 하단에 "이전" 버튼 표시 (선택사항)

- **전체화면 종료**
  - ESC 키 입력 시 전체화면 모드 종료
  - 화면 우측 상단에 "종료" 버튼 표시

#### 2.2.4 진행 상태 표시
- **슬라이드 인디케이터**
  - 현재 몇 번째 화면인지 표시 (예: "3 / 10")
  - 진행 바 표시 (선택사항)

- **현재 화면 정보**
  - 현재 보여주는 모드명과 탭명 표시 (작은 폰트로 상단 또는 하단)

---

## 3. 기술 구현 방안

### 3.1 데이터 구조

```javascript
// 회의 메타데이터 구조 (구글시트: 회의목록 시트)
const meetingMetadata = {
  meetingId: "meeting-2025-01-15-001", // 고유 ID
  meetingName: "2025년 1월 주간회의",
  meetingDate: "2025-01-15",
  meetingNumber: 1, // 차수 (수동 입력)
  createdBy: "사용자명",
  createdAt: "2025-01-15T10:00:00Z",
  status: "completed" // "preparing" | "capturing" | "completed"
};

// 회의 설정 데이터 구조 (구글시트: 회의설정 시트)
const meetingConfig = {
  meetingId: "meeting-2025-01-15-001",
  slides: [
    {
      id: "slide-1",
      type: "mode-tab", // "mode-tab" 또는 "custom"
      mode: "obManagement",
      tab: "overview",
      order: 1,
      capturedImageUrl: "https://cdn.discordapp.com/attachments/.../image1.png", // 캡처 후 저장
      capturedAt: "2025-01-15T10:30:00Z", // 캡처 시간
      discordPostId: "1234567890", // Discord 포스트 ID
      discordThreadId: "0987654321" // Discord 스레드 ID
    },
    {
      id: "slide-2",
      type: "custom",
      title: "회의 안내",
      content: "오늘 회의 주제는...",
      backgroundColor: "#ffffff",
      order: 2,
      capturedImageUrl: "https://cdn.discordapp.com/attachments/.../image2.png",
      capturedAt: "2025-01-15T10:30:05Z",
      discordPostId: "1234567890",
      discordThreadId: "0987654321"
    }
  ]
};
```

### 3.2 구글시트 구조

**시트 1: "회의목록"**
```
회의ID | 회의이름 | 회의날짜 | 차수 | 생성자 | 생성일시 | 상태
meeting-2025-01-15-001 | 2025년 1월 주간회의 | 2025-01-15 | 1 | 홍길동 | 2025-01-15 10:00 | completed
```

**시트 2: "회의설정"**
```
회의ID | 슬라이드ID | 순서 | 타입 | 모드 | 탭 | 제목 | 내용 | 배경색 | 이미지URL | 캡처시간 | Discord포스트ID | Discord스레드ID
meeting-2025-01-15-001 | slide-1 | 1 | mode-tab | obManagement | overview | | | | https://cdn.discordapp.com/... | 2025-01-15 10:30:00 | 1234567890 | 0987654321
meeting-2025-01-15-001 | slide-2 | 2 | custom | | | 회의 안내 | 오늘 회의 주제는... | #ffffff | https://cdn.discordapp.com/... | 2025-01-15 10:30:05 | 1234567890 | 0987654321
```

**구글시트 생성 가이드**
1. 기존 구글시트에 다음 시트들을 추가합니다:
   - 시트 이름: `회의목록`
   - 시트 이름: `회의설정`
2. 각 시트의 1행은 비워두고, 2행에 위의 헤더를 복사하여 붙여넣습니다.
3. 3행부터 데이터가 입력됩니다.

### 3.3 컴포넌트 구조

```
MeetingMode/
├── MeetingPreparationTab.js        # 회의준비 탭
│   ├── MeetingList.js              # 회의 목록 컴포넌트
│   ├── MeetingEditor.js            # 회의 생성/편집 모달
│   ├── ModeSelector.js             # 모드 선택 컴포넌트
│   ├── TabSelector.js              # 탭 선택 컴포넌트
│   ├── SlideOrderEditor.js         # 순서 편집 컴포넌트
│   ├── CustomSlideEditor.js        # 커스텀 화면 편집
│   └── CaptureProgress.js          # 캡처 진행 상황 표시
├── MeetingPresentationTab.js        # 회의진행 탭
│   ├── MeetingSelector.js         # 회의 선택
│   ├── FullscreenSlideView.js      # 전체화면 슬라이드 뷰
│   ├── ImageSlideRenderer.js       # 이미지 기반 슬라이드 렌더러
│   ├── SlideNavigator.js           # 네비게이션 컨트롤
│   └── ImagePreloader.js           # 이미지 preload 유틸리티
└── MeetingConfigManager.js         # 설정 저장/로드 관리
    ├── GoogleSheetService.js       # 구글시트 연동
    └── DiscordService.js           # Discord 이미지 업로드
```

### 3.4 화면 캡처 기술

**html2canvas 라이브러리 사용**
- DOM 요소를 Canvas로 변환 후 이미지로 저장
- **캡처 대상**: presentation mode로 렌더링된 콘텐츠 영역만 캡처
- **제외 대상**: 
  - 회의 모드 상단 AppBar (뒤로가기, 탭, 모드 변경 버튼 등)
  - 각 모드의 헤더/네비게이션 바
  - 브라우저 주소창 등
- 고해상도 캡처 설정 (1920x1080 이상, 4K 지원)
- 파일 크기 최적화 (압축, 품질 조절)

**캡처 프로세스 (회의 생성 시)**
1. 회의 생성 버튼 클릭
2. 설정된 슬라이드 순서대로 반복:
   a. 해당 모드/탭 컴포넌트를 **presentation mode로 렌더링** (헤더/네비게이션 숨김)
   b. 데이터 로딩 완료 대기
   c. **presentation mode로 렌더링된 콘텐츠 컨테이너만 선택**
   d. html2canvas로 Canvas 생성 (고해상도 설정)
   e. Canvas를 Blob으로 변환 (압축 적용)
   f. Discord API에 업로드
   g. Discord에서 반환된 이미지 URL 및 포스트/스레드 ID 획득
   h. 구글시트에 URL 저장
3. 모든 슬라이드 캡처 완료 후 회의 상태를 "completed"로 변경

**캡처되는 내용**
- ✅ 각 모드/탭의 실제 콘텐츠 (제목, 테이블, 차트, 폼 등)
- ✅ 커스텀 화면의 제목과 내용
- ❌ 회의 모드 상단 헤더 (제외)
- ❌ 각 모드의 헤더/네비게이션 (제외)

**캡처 설정**
```javascript
const captureOptions = {
  scale: 2, // 고해상도 (2배)
  useCORS: true,
  allowTaint: false,
  backgroundColor: '#ffffff',
  width: window.innerWidth,
  height: window.innerHeight,
  logging: false
};
```

### 3.5 Discord 봇 연동

**기존 Discord 봇 활용**
- `server/monitor.js`에 이미 Discord 봇 구현되어 있음
- 동일한 봇을 활용하여 이미지 업로드 기능 확장

**Discord 포럼 게시판 구조**
- 채널 ID: `1438813568374931578` (포럼 게시판)
- 년월별 포스트 자동 생성 (예: "2025-01 회의")
- 각 회의는 포스트 내의 스레드로 관리
- 이미지는 스레드에 업로드

**구현 방식**
```javascript
// server/meetingRoutes.js (신규 생성)
async function uploadImageToDiscord(imageBuffer, filename, meetingId, meetingDate) {
  const channel = await discordBot.channels.fetch('1438813568374931578');
  
  // 년월 추출 (예: "2025-01")
  const yearMonth = meetingDate.substring(0, 7);
  
  // 해당 년월의 포스트 찾기 또는 생성
  let post = await findOrCreatePost(channel, yearMonth);
  
  // 회의 스레드 찾기 또는 생성
  let thread = await findOrCreateThread(post, meetingId);
  
  // 이미지 업로드
  const attachment = new AttachmentBuilder(imageBuffer, { name: filename });
  const message = await thread.send({ files: [attachment] });
  
  return {
    imageUrl: message.attachments.first().url,
    postId: post.id,
    threadId: thread.id
  };
}
```

### 3.6 이미지 로딩 최적화

**Preload 전략**
- 현재 이미지 표시 중 다음 이미지 미리 로딩
- 이미지 캐싱 활용
- 로딩 중 스피너 및 진행 상태 표시

**로딩 UI**
- Material-UI CircularProgress 사용
- 이미지 로딩 중 반투명 오버레이 표시
- 로딩 완료 시 부드러운 전환 애니메이션

---

## 4. 구현 단계

### Phase 1: 기본 구조 및 회의 목록 관리 ✅
- [x] MeetingMode 컴포넌트에 탭 구조 추가 (회의준비/회의진행)
- [x] 구글시트 "회의목록" 시트 구조 생성 (사용자가 수동 생성)
- [x] 회의 목록 조회/표시 기능
- [x] 회의 생성 모달 (2단계: 모드/탭 선택 → 회의 정보 입력)
- [x] 차수 중복 방지 로직 (같은 날짜 + 같은 차수 체크)
- [x] 회의 편집/삭제 기능 (구글시트에서만 삭제)

### Phase 2: 회의준비 탭 - 모드/탭 선택 ✅
- [x] 회의준비 탭 UI 구현
- [x] 사용 가능한 모드 목록 표시 (권한이 있는 모든 모드)
- [x] 모드 선택 시 해당 모드의 탭 목록 표시
- [x] 탭 선택 체크박스 구현
- [x] 모드/탭 매핑 구조 정의 (modeTabConfig.js)
- [x] 하부 탭(서브탭) 선택 기능 추가 (예: 채권장표 > 재초담초채권)
- [x] 모드 전체 추가 기능 (탭이 없는 모드의 경우)

### Phase 3: 순서 설정 및 구글시트 저장 ✅
- [x] 선택된 탭 리스트 표시
- [x] 위/아래 화살표 버튼으로 순서 변경
- [x] 구글시트 "회의설정" 시트 구조 생성 (사용자가 수동 생성)
- [x] 회의 설정 저장 API 구현 (백엔드)
- [x] 회의 설정 불러오기 기능

### Phase 4: 커스텀 화면 추가 ✅
- [x] 커스텀 화면 추가 UI
- [x] 커스텀 화면 편집 모달
- [x] 커스텀 화면을 슬라이드 목록에 포함
- [x] 구글시트에 커스텀 화면 정보 저장
- [x] 커스텀 화면에 이미지 업로드 기능 추가 (로컬 파일 → Discord 업로드 → URL 저장)

### Phase 5: 화면 캡처 기능 ✅
- [x] html2canvas 라이브러리 설치 및 설정
- [x] 화면 캡처 함수 구현 (DOM → Canvas → Blob)
- [x] 고해상도 캡처 설정 (scale: 2)
- [x] 이미지 압축 및 최적화 (품질 0.95)
- [x] 이미지 파일명 생성 로직 (`{회의ID}_{슬라이드순서}_{타임스탬프}.png`)

### Phase 6: Discord 봇 연동 ✅
- [x] Discord 포럼 게시판 연동
- [x] 년월별 포스트 찾기/생성 로직
- [x] 회의별 스레드 찾기/생성 로직
- [x] Discord 이미지 업로드 API 구현 (백엔드)
- [x] Discord 채널 ID 환경변수 설정 (`DISCORD_MEETING_CHANNEL_ID=1438813568374931578`)
- [x] 이미지 업로드 및 URL/포스트ID/스레드ID 획득
- [x] 에러 처리 및 재시도 로직
- [x] Discord 포스트 이름에 회의 차수 추가 (예: "2025-11 회의 - 1차")

### Phase 7: 회의 생성 시 자동 캡처 ✅
- [x] 회의 생성 모달에서 2단계 플로우 구현
  - 1단계: 모드/탭 선택 및 슬라이드 순서 설정
  - 2단계: 회의 정보 입력 (이름, 날짜, 차수)
- [x] "생성 및 저장" 버튼 클릭 시 회의 생성 + 설정 저장 + 캡처 프로세스 시작
- [x] 설정된 슬라이드 순서대로 자동 캡처
- [x] 각 슬라이드의 모드/탭 컴포넌트 렌더링 (SlideRenderer)
- [x] 데이터 로딩 완료 대기 로직 (MutationObserver 사용, 안정성 5초 유지)
- [x] 실제 데이터 렌더링 완료 후에만 캡처하도록 개선
- [x] 캡처 진행 상황 표시 (진행 바, 완료된 슬라이드 수)
- [x] 모든 슬라이드 캡처 완료 후 구글시트에 URL 저장 (각 슬라이드별 개별 저장)
- [x] 회의 상태 업데이트 ("capturing" → "completed")
- [x] saveMeetingConfig 400 에러 수정 (슬라이드 배열 검증 강화)

### Phase 8: 회의진행 탭 기본 구조 ✅
- [x] 회의진행 탭 UI 구현
- [x] 지난 회의 목록 표시 (완료된 회의만)
- [x] 회의 선택 UI
- [x] 전체화면 API 연동
- [x] 슬라이드 인디케이터 표시

### Phase 9: 이미지 슬라이드 재생 ✅
- [x] 선택한 회의의 이미지 URL 목록 불러오기
- [x] 이미지 기반 슬라이드 렌더러 구현 (ImageSlideViewer)
- [x] 이미지 preload 기능 (다음 이미지 미리 로딩)
- [x] 이미지 로딩 및 표시
- [x] 로딩 중 UI 표시 (CircularProgress)
- [x] 로딩 완료 시 부드러운 전환 애니메이션

### Phase 10: 슬라이드 네비게이션 ✅
- [x] 키보드 이벤트 처리 (스페이스바, ESC, 화살표)
- [x] 마우스 클릭 이벤트 처리
- [x] 이전/다음 버튼 구현
- [x] 진행 상태 표시 (현재/전체 슬라이드 수)

### Phase 11: Presentation Mode 구현 ✅
- [x] 각 모드의 탭 컴포넌트 매핑 (modeTabConfig.js)
- [x] Presentation mode prop 추가 (ChartMode 컴포넌트 수정 완료)
- [x] SlideRenderer 컴포넌트 구현 (기본 구조)
- [x] 커스텀 화면 렌더링
- [x] 캡처 대상 DOM 요소 선택 로직 (data-slide-id 속성 사용)
- [x] 실제 모드 컴포넌트를 presentation mode로 렌더링 (ChartMode 수정 완료)
- [x] 하부 탭(서브탭) 선택 기능 추가
- [x] 데이터 로딩 완료 감지 로직 강화 (MutationObserver 사용, 안정성 5초 유지)
- [x] 실제 데이터 렌더링 완료 후에만 캡처하도록 개선

### Phase 12: 테스트 및 최적화 (진행 중)
- [x] 각 모드별 테스트 (장표 모드 완료)
- [x] 이미지 캡처 품질 테스트 (고해상도 확인)
- [x] Discord 업로드 안정성 테스트
- [x] 이미지 로딩 성능 테스트
- [x] 데이터 로딩 완료 감지 로직 개선 (MutationObserver 사용)
- [x] 실제 데이터 렌더링 완료 후에만 캡처하도록 개선
- [x] 구글시트 각 슬라이드별 URL 개별 저장 문제 해결
- [x] saveMeetingConfig 400 에러 수정
- [ ] 다른 모드별 테스트 (OB 관리 모드, 예산 모드 등)
- [ ] 성능 최적화 (이미지 로딩, 렌더링, 메모리 관리)
- [ ] UX 개선

---

## 5. 기술 스택 및 라이브러리

### 5.1 필수 라이브러리
- **html2canvas**: DOM을 Canvas로 변환하여 이미지 생성
  ```bash
  npm install html2canvas
  ```

- **@dnd-kit/core**: 드래그 앤 드롭 기능
  ```bash
  npm install @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities
  ```

### 5.2 Discord 연동
- **discord.js**: Discord 봇과의 통신 (서버 측)
  - 기존 `server/monitor.js`에서 사용 중
  - 이미지 업로드를 위한 `AttachmentBuilder` 사용
  - 포럼 게시판 및 스레드 관리

### 5.3 구글시트 연동
- **googleapis**: 구글시트 API 연동 (서버 측)
  - 기존 프로젝트에서 사용 중인 패턴 참고

### 5.4 환경변수 추가 필요
```env
# Discord 설정
DISCORD_MEETING_CHANNEL_ID=1438813568374931578  # 회의 이미지 저장용 포럼 게시판

# 구글시트 설정 (기존 시트 ID 사용)
# MEETING_SHEET_ID는 기존 SHEET_ID와 동일하게 사용
```

---

## 6. 구현 시 주의사항

### 6.1 화면 캡처 시 주의
- **동적 콘텐츠**: 로딩 중인 데이터가 있으면 완료 후 캡처
- **외부 리소스**: 외부 이미지나 폰트가 로드될 때까지 대기
- **애니메이션**: CSS 애니메이션이 진행 중이면 완료 후 캡처
- **iframe**: iframe 내부 콘텐츠는 별도 처리 필요
- **고해상도**: 1920x1080 이상 설정, 파일 크기 최적화 고려

### 6.2 Discord 업로드 제한
- **파일 크기**: 최대 25MB
- **업로드 속도**: 너무 빠른 연속 업로드 시 rate limit 발생 가능
- **에러 처리**: 업로드 실패 시 재시도 로직 필요
- **포럼 게시판**: 포스트 및 스레드 생성 시 권한 확인

### 6.3 구글시트 저장 최적화
- **배치 저장**: 여러 슬라이드 URL을 한 번에 저장
- **에러 복구**: 저장 실패 시 재시도 및 로컬 백업
- **데이터 검증**: URL 유효성 검사
- **차수 중복 방지**: 같은 날짜 + 같은 차수 체크

### 6.4 성능 최적화
- **이미지 로딩**: 지난 회의 재생 시 이미지 preload
- **메모리 관리**: 많은 이미지를 로드할 때 메모리 누수 방지
- **렌더링 최적화**: 불필요한 리렌더링 방지
- **이미지 압축**: 고해상도 유지하면서 파일 크기 최적화

### 6.5 회의 삭제 시
- **구글시트만 삭제**: Discord 이미지는 유지하여 자료 보존
- **삭제 확인**: 사용자에게 확인 메시지 표시

---

## 7. 구글시트 시트 생성 가이드

### 7.1 시트 생성 방법
1. 기존 구글시트를 엽니다 (SHEET_ID 사용)
2. 하단에 새 시트를 추가합니다:
   - 시트 이름: `회의목록`
   - 시트 이름: `회의설정`

### 7.2 "회의목록" 시트 헤더
1행은 비워두고, 2행에 다음 헤더를 복사하여 붙여넣습니다:

```
회의ID	회의이름	회의날짜	차수	생성자	생성일시	상태
```

### 7.3 "회의설정" 시트 헤더
1행은 비워두고, 2행에 다음 헤더를 복사하여 붙여넣습니다:

```
회의ID	슬라이드ID	순서	타입	모드	탭	제목	내용	배경색	이미지URL	캡처시간	Discord포스트ID	Discord스레드ID
```

### 7.4 참고사항
- 1행은 항상 비워둡니다 (데이터는 3행부터 입력)
- 헤더는 2행에만 입력합니다
- 탭 문자(`\t`)로 구분되어 있습니다 (복사 시 자동으로 컬럼 분리됨)

---

## 8. 다음 단계

1. ✅ 요구사항 확정 완료
2. 구글시트 시트 생성 (사용자가 수동 생성)
3. 환경변수 설정 (`DISCORD_MEETING_CHANNEL_ID`)
4. Phase 1부터 순차적으로 구현 시작

---

## 9. 테스트 단계

### ✅ 1단계: 회의 목록 조회 (회의준비 탭) - 완료
- [x] 회의 모드 진입 확인
- [x] "회의준비" 탭 선택 확인
- [x] 회의 목록 정상 표시 확인
- [x] 빈 목록 시 "회의가 없습니다" 메시지 표시 확인

### ✅ 2단계: 새 회의 생성 - 모드/탭 선택 - 완료
- [x] "새 회의 생성" 버튼 클릭 확인
- [x] Step 0: 모드/탭 선택 화면 표시 확인
- [x] 권한이 있는 모든 모드 표시 확인
- [x] 모드 선택 시 탭 목록 표시 확인
- [x] 하부 탭(서브탭) 표시 및 선택 가능 확인
- [x] "커스텀 화면 추가" 버튼 동작 확인
- [x] 슬라이드 순서 편집(위/아래 이동) 동작 확인
- [x] 최소 1개 이상 슬라이드 선택 후 "다음" 버튼 활성화 확인

### ✅ 3단계: 새 회의 생성 - 회의 정보 입력 - 완료
- [x] Step 1: 회의 정보 입력 화면 표시 확인
- [x] 회의 이름 입력 확인
- [x] 회의 날짜 선택 확인
- [x] 차수 입력 확인
- [x] 같은 날짜에 동일 차수 존재 시 에러 메시지 표시 확인
- [x] "생성 및 저장" 버튼 클릭 확인
- [x] 회의 생성 후 바로 캡처 화면으로 이동 확인

### 4단계: 화면 캡처 자동 시작 (진행 중)
- [x] 회의 생성 후 자동으로 캡처 화면으로 이동 확인
- [x] 각 슬라이드별 캡처 진행 상황 표시 확인
- [x] 진행률 표시 확인
- [x] 각 슬라이드의 실제 모드/탭 화면이 정상적으로 렌더링되는지 확인
- [x] 데이터 로딩 완료 후 실제 데이터 화면이 캡처되는지 확인 (로딩 화면 제외)
- [x] 캡처 완료 후 Discord 업로드 확인
- [x] Google Sheet에 각 슬라이드별 이미지 URL 개별 저장 확인
- [x] Discord 포스트 이름에 회의 차수 포함 확인 (예: "2025-11 회의 - 1차")
- [x] 캡처 완료 후 회의 상태가 "completed"로 업데이트되는지 확인
- [ ] 캡처 완료 후 목록으로 돌아가는지 확인

### 5단계: 회의 수정
- [ ] 회의 목록에서 "수정" 버튼 클릭 확인
- [ ] 회의 정보 수정 가능 확인
- [ ] 저장 후 목록에 반영 확인

### 6단계: 회의 설정 편집
- [ ] 회의 목록에서 회의 선택 확인
- [ ] 모드/탭 선택 및 슬라이드 순서 변경 가능 확인
- [ ] 커스텀 화면 추가/삭제 가능 확인
- [ ] 저장 후 재캡처 가능 확인

### 7단계: 회의진행 탭 - 지난 회의 재생
- [ ] "회의진행" 탭 선택 확인
- [ ] 완료된 회의 목록 표시 확인
- [ ] 회의 선택 후 "재생" 버튼 클릭 확인
- [ ] 전체화면 모드로 전환 확인
- [ ] 스페이스바 또는 클릭으로 다음 슬라이드 이동 확인
- [ ] ESC 키로 전체화면 종료 확인
- [ ] 이미지가 정상적으로 로드되는지 확인

### 8단계: 회의 삭제
- [ ] 회의 목록에서 "삭제" 버튼 클릭 확인
- [ ] 확인 메시지 표시 확인
- [ ] 삭제 후 목록에서 제거 확인
- [ ] Discord 이미지는 유지되는지 확인

---

## 10. 최근 완료된 개선 사항

### 10.1 커스텀 슬라이드 이미지 업로드 기능
- 로컬 컴퓨터에서 이미지 파일 선택
- Discord에 자동 업로드
- 업로드된 이미지 URL을 커스텀 슬라이드에 저장
- 이미지 미리보기 및 제거 기능

### 10.2 Discord 포스트 이름 개선
- 기존: "2025-11 회의"
- 변경: "2025-11 회의 - 1차", "2025-11 회의 - 2차" 등
- 회의 차수별로 포스트 구분하여 이미지 관리 용이

### 10.3 로딩 화면 캡처 문제 해결
- 실제 데이터 렌더링 완료 후에만 캡처하도록 개선
- MutationObserver를 사용한 DOM 변경 감지
- 안정적인 상태 5초 유지 후 캡처
- 실제 테이블 행이 렌더링되었는지 확인

### 10.4 구글시트 저장 문제 해결
- 각 슬라이드별 URL이 개별 저장되도록 수정
- saveMeetingConfig 400 에러 수정 (슬라이드 배열 검증 강화)
- 회의 상태 업데이트 로직 개선

### 10.5 하부 탭(서브탭) 선택 기능
- 채권장표 > 재초담초채권, 연체채권 등 하부 탭 선택 가능
- 모드/탭 선택 화면에서 하부 탭을 작은 칩으로 표시

---

## 11. 참고 사항

- 기존 모드 컴포넌트들의 구조를 최대한 활용
- Material-UI 컴포넌트 사용 (기존 스타일과 일관성 유지)
- 반응형 디자인 고려 (다양한 화면 크기 지원)
- 접근성 고려 (키보드 네비게이션, 스크린 리더 지원)
- 이미지 파일 크기 최적화 (Discord 업로드 제한: 25MB)
- Discord CDN URL은 영구적으로 유지되므로 안정적으로 사용 가능
- **플랜 파일은 로컬에서만 관리하며 깃에 커밋하지 않음**
